<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ws="ws-component">
<head>
   <title>Demo: MultiView</title>
   <script type="text/javascript">
      window.wsConfig = {
         WSRootPath: '/sbis3-ws/ws/',
         wsRoot: '/sbis3-ws/ws/',
         WSTheme: 'wi_scheme',
         resourceRoot: '/',
         nostyle: true,
         globalConfigSupport: false
      };
      window.WSTheme = 'wi_scheme';
   </script>
   <script type="text/javascript" id="dev-style-enable">
      (function () {
         window.wsConfig.nostyle = false;
      })();
   </script>
   <script type="text/javascript" data-pack-name="contents" src="/contents.js"></script>
   <script type="text/javascript" data-pack-name="ws" src="/sbis3-ws/ws/ext/jquery-min.js"></script>
   <script type="text/javascript" data-pack-name="ws" src="/sbis3-ws/ws/ext/jquery-cookie-min.js"></script>
   <script type="text/javascript" data-pack-name="ws" src="/sbis3-ws/ws/ext/jquery-notouch-min.js"></script>
   <script type="text/javascript" src="/sbis3-ws/ws/ext/requirejs/require.js"></script>
   <script type="text/javascript" src="/sbis3-ws/ws/ext/requirejs/config.js"></script>
   <link rel="stylesheet" type="text/css" href="/sbis3-ws/ws/css/core.css"/>
   <script type="text/javascript" src="/sbis3-ws/ws/lib/core.js"></script>
   <script type="text/javascript" src="/sbis3-ws/ws/lib/Source.js"></script>
   <script type="text/javascript" data-pack-name="ws" src="/sbis3-ws/ws/res/js/bootup.js"></script>
   <style>
      html, body {
         font-family: Tahoma !important;
         font-size: 13px;
      }

      .wrapper {
         width: 50%;
         margin: 20px auto;
         padding: 50px;
         border: 1px gray solid;
      }

      .txt{
         height: 24px;
         padding-top:4px;
         vertical-align: middle;
         display: inline-block;
         float: left;
      }
      .view-main {
         font-family: Arial, SANS-SERIF;
         font-size: 13px;
         padding: 0;
         height: 100%;
      }
      .controls-CompositeView .controls-CompositeView__tileItem{
         width: 278px;
         height: 237px;
      }
      .tile-price{
         font-weight: 600;
         position: absolute;
         bottom: 10px;
         right: 15px;
         font-size: 16px;
      }
      .tile-count{
         position: absolute;
         left: 10px;
         bottom: 10px;
         font-weight: 400;
         font-size: 11px;
         color: #BBBBBB;
      }
   </style>
   <script type="text/javascript" id="ws-include-css"></script>

   <link rel="stylesheet" type="text/css" href="../fonts/index.css"/>
   <link rel="stylesheet" type="text/css" href="../icons/index.css"/>

   <link rel="stylesheet" type="text/css" href="../components/themes/online/online.css"/>
</head>
<body class="view-main">
<div id="Back"></div>

<div class="wrapper">
   <h2>HierarchyCompositeView</h2>
   <div id="radio2" style="margin-bottom: 24px;"></div>
   <div id="tbMVH"></div>
      <div id="BreadCrumbs1"></div>
      <div id="BackButton"></div>  
   <div id="CompositeViewHier"></div>
   <hr>
    <h2>TreeDataGridView</h2>
   <div id="tbTG"></div>
    <div id="BreadCrumbs3"></div>
   <div id="TreeGrid"></div>
   <hr>
    <h2>CompositeView</h2>
   <div id="radio" style="margin-bottom: 24px;"></div>
   <div id="tbMV"></div>
   <div id="CompositeView"></div>


</div>


<script type="text/javascript">
   require(['Core/core-init'],function () {
      $(document).ready(function () {

         var getColorChannel = function() {
               return Math.round(255 * Math.random()).toString(16);
            },
            getColorMark = function() {
               return '';// + Math.round(15 * Math.random()).toString(16) + getColorChannel() + getColorChannel() + getColorChannel();
            },
            coll = [
            {
               id : 3,
               title : 'Настолько длинное название папки что оно не влезет в максимальный размер',
               color: getColorMark(),
               'par@' : true
            },
            {
               id : 1,
               title : 'Notebooks',
               color: getColorMark(),
               'par@' : true
            },
            {
               id : 2,
               title : 'Smartphones',
               color: getColorMark(),
               'par@' : true
            },
            {
               id : 4,
               title : 'Notebook Lenovo G505 59426068',
               color: getColorMark(),
               flag: true,
               img : 'img/4.png',
               par : 9,
               'par@': null,
               price: '11 490',
               count: 2
            },
            {
               id : 6,
               title : 'Notebook ASUS X550LC-XO228H',
               color: getColorMark(),
               flag: true,
               img : 'img/6.png',
               par : 10,
               'par@' : null,
               price: '19 990',
               count: 22
            },
            {
               id : 7,
               title : 'Notebook Lenovo IdeaPad G5030 (80G0001FRK)',
               color: getColorMark(),
               flag: true,
               img : 'img/7.png',
               price: '22 590',
               par : 9,
               'par@' : null,
               count: 13
            },
            {
               id : 8,
               title : 'Notebook Lenovo G505 59426068',
               color: getColorMark(),
               flag: true,
               img : 'img/8.png',
               price: '25 100',
               par : 9,
               'par@' : null,
               count: 5
            },
            {
               id : 9,
               title : 'Lenovo',
               color: getColorMark(),
               par : 1,
               'par@' : true
            },
            {
               id : 10,
               title : 'ASUS',
               color: getColorMark(),
               par : 1,
               'par@' : true
            },
            {
               id : 11,
               title : 'Samsung',
               color: getColorMark(),
               par : 2,
               'par@' : true
            },
            {
               id : 12,
               title : 'SONY',
               color: getColorMark(),
               par : 2,
               'par@' : true
            },
            {
               id : 13,
               title : 'ASUS',
               color: getColorMark(),
               par : 2,
               'par@' : true
            },
            {
               id : 5,
               title : 'Notebook Packard Bell EasyNote TE69HW-29572G32',
               color: getColorMark(),
               flag: true,
               img : 'img/5.png',
               par : 1,
               'par@' : null,
               price: '15 990',
               count: 12
            },
            {
               id : 14,
               title : 'Sony Xperia Z3 Compact',
               color: getColorMark(),
               flag: true,
               par : 12,
               'par@' : null,
               price: '20 290',
               count: 7
            },
            {
               id : 15,
               title : 'Samsung Galaxy S6 SM-G920F 32Gb',
               color: getColorMark(),
               flag: true,
               par : 11,
               'par@' : null,
               price: '31 700',
               count: 9
            },
            {
               id : 16,
               title : 'ASUS ZenFone 2 ZE550ML',
               color: getColorMark(),
               flag: true,
               par : 13,
               'par@' : null,
               price: '12 890',
               count: 6
            },
            {
               id : 17,
               title : 'Sony Xperia Z3 (D6603)',
               flag: true,
               par : 12,
               'par@' : null,
               price: '24 750',
               count: 3
            },
            {
               id : 18,
               title : 'Samsung Galaxy Note 4 SM-N910C',
               flag: true,
               par : 11,
               'par@' : null,
               price: '29 320',
               count: 2
            },
            {
               id : 19,
               title : 'Вложенные папки',
               color: getColorMark(),
               par : 3,
               'par@' : true
            },
            {
               id : 20,
               title : 'Для проверки',
               color: getColorMark(),
               par : 19,
               'par@' : true
            },
            {
               id : 21,
               title : 'Хлебных крошек',
               color: getColorMark(),
               par : 20,
               'par@' : true
            },
            {
               id : 22,
               title : 'Ооооооооочень',
               color: getColorMark(),
               par : 21,
               'par@' : true
            },
            {
               id : 23,
               title : 'Многооооооооо',
               color: getColorMark(),
               par : 22,
               'par@' : true
            },
            {
               id : 24,
               title : 'Папоооооооооок',
               color: getColorMark(),
               par : 23,
               'par@' : true
            },
            {
               id : 25,
               title : 'Есть даже папки с длинными названиями',
               par : 24,
               'par@' : true
            },
            {
               id : 26,
               title : 'И не очень длинными',
               par : 25,
               'par@' : true
            },
            {
               id : 27,
               title : 'И чуть более длинными',
               par : 26,
               'par@' : true
            },
            {
               id : 28,
               title : 'А тут',
               par : 27,
               'par@' : null
            },
            {
               id : 29,
               title : 'Даже',
               par : 27,
               'par@' : null
            },
            {
               id : 30,
               title : 'что то есть',
               par : 27,
               'par@' : null
            }
         ];

         var col2 = [
            {
               id : 'table',
               title : 'Таблица'
            },
            {
               id : 'list',
               title : 'Список'
            },
            {
               id: 'tile',
               title: 'Плитка'
            }
         ];




         require(["SBIS3.CONTROLS/Radio/Group", "SBIS3.CONTROLS/Tree/CompositeView", 'SBIS3.CONTROLS/TextBox'], function (r, cm, TB) {
            var radio = new r({
               element: "radio",
               items: col2,
               displayField: 'title',
               selectedKey : 'table'
            });

            var mv1 = new cm({
               element: "CompositeView",
               tileTemplate:  '<div>' +
                                 '<div class="controls-ListView__itemCheckBox"></div>' +
                                 '<img class="controls-CompositeView__tileImg" src="{{=it.item.get(it.image)}}"/>' +
                                 '<div class="controls-CompositeView__tileText">{{=it.item.get(\'title\')}}</div>' +
                                 '<div class="tile-price">{{=it.item.get(\'price\')}}</div>' +
                                 '<div class="tile-count">Кол-во:{{=it.item.get(\'count\')}}</div>' +
                              '</div>',
               /*tileTpl : '{{it.className="hhh";}}{{=it.defaultTileTpl(it)}}',
               tileContentTpl : '<div class="controls-ListView__itemCheckBox"></div>' +
                     '<img class="controls-CompositeView__tileImg" src="{{=it.item.get(it.image)}}"/>' +
                     '<div class="controls-CompositeView__tileText">{{=it.item.get(\'title\')}}</div>' +
                     '<div class="tile-price">{{=it.item.get(\'price\')}}</div>' +
                     '<div class="tile-count">Кол-во:{{=it.item.get(\'count\')}}</div>',*/
               multiselect: true,
               highlightEnabled: true,
               colorMarkEnabled: true,
               colorField: 'color',
               hierField : 'par',
               itemsActions: [
               	{
                  name: 'a',
                  title: 'Прочитать',
                  isMainAction: true,
                  onActivated: function (item) {
                     alert('Что то сделалось с item #' + item.data('id'));
                  }
               	},
               	{
                  name: 'b',
                  title: 'Ответить',
                  isMainAction: true,
                  onActivated: function (item) {
                     alert('Что то сделалось с item #' + item.data('id'));
                  }
               	},
                {
                    name: 'delete1',
                    icon: 'sprite:icon-16 icon-Erase icon-error',
                    title: 'Удалить 2',
                    isMainAction: false,
                    onActivated: function (item) {
                       this.deleteRecords(item.data('id'));
                    }
                },
                {
                  name: 'delete',
                  icon: 'sprite:icon-16 icon-Publish2 icon-primary',
                  title: 'Че то сделать 1',
                  isMainAction: true,
                  onActivated: function (item) {
                     alert('Что то сделалось с item #' + item.data('id'));
                  }
               	}],
               viewMode: radio.getSelectedKey(),
               items: coll,
               displayField : 'title',
               imageField : 'img',
               columns : [
                  {
                     title : 'Ид',
                     field : 'id',
                     headTooltip : 'Номерок'
                  },
                  {
                     title : 'Имя',
                     field  : 'title'
                  },
                  {
                     title : 'Цена',
                     field : 'price',
                     width : 70
                  },
                  {
                     title : 'Флаг',
                     field : 'flag',
                     width : 50
                  },
                  {
                     title : 'Иконка',
                     field : 'img',
                     width : 60,
                     cellTemplate : '<div><img style="width:16px;height:16px;" src="{{=it.item.get(it.field)}}"/></div>'
                  }
               ],

            });

            radio.subscribe('onSelectedItemChange', function(e, type){
               mv1.setViewMode(type);
               mv1._redraw();
            });

            var tb = new TB({
               element: 'tbMV',
               placeholder: 'найти...'
            });
            tb.subscribe('onTextChange', function(e, text) {
               mv1.setHighlightText(text);
            });



            

//            require(['SBIS3.CONTROLS/Tree/DataGridView', 'SBIS3.CONTROLS/BreadCrumbs', 'SBIS3.CONTROLS/TextBox'], function(tdg, PS, TB){
//               var treedatagreed = new tdg ({
//                  'element' : 'TreeGrid',
//                  items: coll,
//                  hierField : 'par',
//                  displayField: 'title',
//                  itemsActions: [],
//                  multiselect: true,
//                  highlightEnabled: true,
//                  colorMarkEnabled: true,
//                  colorField: 'color',
//                  showPaging : true,
//                  pageSize : 2,
//                  columns : [
//                 /*    {
//                        title : 'Ид',
//                        field : 'id',
//                        width : 50
//                     },*/
//                     {
//                        title : 'Имя',
//                        field  : 'title'
//                     }/*,
//                     {
//                        title : 'Флаг',
//                        field : 'flag',
//                        width : 50
//                     },
//                     {
//                        title : 'Иконка',
//                        field : 'img',
//                        width : 60,
//                        cellTemplate : '<div><img style="width:16px;height:16px;" src="{{=it.item.get(it.field)}}"/></div>'
//                     }*/
//                  ]
//               })
//
//               new PS({
//                  linkedView: treedatagreed,
//                  element: 'BreadCrumbs3'
//               })
//
//               var tb = new TB({
//                  element: 'tbTG',
//                  placeholder: 'найти...'
//               });
//               tb.subscribe('onTextChange', function(e, text) {
//                  treedatagreed.setHighlightText(text);
//               });
//            });

//            require(['SBIS3.CONTROLS/Tree/CompositeView', 'SBIS3.CONTROLS/BreadCrumbs', 'SBIS3.CONTROLS/TextBox', 'SBIS3.CONTROLS/ComponentBinder', 'SBIS3.CONTROLS/Button/BackButton'], function(hmv, PS, TB, ComponentBinder, BackButton){
//               var radio2 = new r({
//                  element: "radio2",
//                  items: col2,
//                  captionField: 'title',
//                  selectedKey : 'table'
//               });
//
//               var hmv = new hmv ({
//                  element : 'CompositeViewHier',
//                  items: coll,
//                          itemsActions: [
//               	{
//                  name: 'a',
//                  title: 'Прочитать',
//                  caption: 'Прочитать',
//                  isMainAction: true,
//                  onActivated: function (item) {
//                     alert('Что то сделалось с item #' + item.data('id'));
//                  }
//               	},
//               	{
//                  name: 'b',
//                  title: 'Ответить',
//                  caption: 'Ответить',
//                  isMainAction: true,
//                  onActivated: function (item) {
//                     alert('Что то сделалось с item #' + item.data('id'));
//                  }
//               	},
//                {
//                    name: 'delete1',
//                    icon: 'sprite:icon-16 icon-Erase icon-error',
//                    title: 'Удалить 2',
//                    isMainAction: true,
//                    onActivated: function (item) {
//                       this.deleteRecords(item.data('id'));
//                    }
//                },
//                {
//                  name: 'delete',
//                  icon: 'sprite:icon-16 icon-Publish2 icon-primary',
//                  title: 'Че то сделать 1',
//                  isMainAction: false,
//                  onActivated: function (item) {
//                     alert('Что то сделалось с item #' + item.data('id'));
//                  }
//               	}],
//                  hierField : 'par',
//                  displayField : 'title',
//                  imageField : 'img',
//                  multiselect: true,
//                  highlightEnabled: true,
//                  colorMarkEnabled: true,
//                  colorField: 'color',
//                  keyField: 'id',
//                  emptyHTML: 'Нет данных',
//                  /*showPaging : true,
//                  pageSize : 2,*/
//                  columns : [
//                     {
//                        title : 'Имя',
//                        field  : 'title'
//                     },
//                     {
//                        title : 'Цена',
//                        field : 'price',
//                        width : 100
//                     },
//                     {
//                        title : 'Наличие',
//                        field : 'flag',
//                        width : 50
//                     },
//                     {
//                        title : 'Иконка',
//                        field : 'img',
//                        width : 60,
//                        cellTemplate : '<div><img style="width:16px;height:16px;" src="{{=it.item.get(it.field)}}"/></div>'
//                     }
//                  ]
//               });
//
//               var ps1 = new PS ({
//                  element: 'BreadCrumbs1',
//                  linkedView: hmv,
//                  highlightEnabled: true,
//                  colorMarkEnabled: true,
//                  colorField: 'color'
//               });
//
//
//               var bb = new BackButton({
//                  element : 'BackButton'
//               });
//
//               var binder = new ComponentBinder({
//                  breadCrumbs : ps1,
//                  backButton: bb,
//                  view: hmv
//               });
//
//               binder.bindBreadCrumbs();
//
//               var tb = new TB({
//                  element: 'tbMVH',
//                  placeholder: 'найти...'
//               });
//               tb.subscribe('onTextChange', function(e, text) {
//                  hmv.setHighlightText(text);
//                  ps1.setHighlightText(text);
//               });
//
//               radio2.subscribe('onSelectedItemChange', function(e, type){
//                  hmv.setViewMode(type);
//                  hmv.reload();
//               });
//            })

         });


      })
   });
</script>
</body>
</html>
