/// <amd-module name="Data/_chain/Concatenated" />
/**
 * Объединяющее звено цепочки.
 * @class WS.Data/Chain/Concatenated
 * @extends WS.Data/Chain/Abstract
 * @public
 * @author Мальцев А.А.
 */

import Abstract from './Abstract';
import ConcatenatedEnumerator from './ConcatenatedEnumerator';
import {IEnumerable} from '../collection';

export default class Concatenated<T> extends Abstract<T> /** @lends WS.Data/Chain/Concatenated.prototype */{
   /**
    * @property {Array.<Array>|Array.<WS.Data/Collection/IEnumerable>} Коллекции для объединения
    */
   protected _items: Array<Array<T> | IEnumerable<T>>;

   /**
    * Конструктор объединяющего звена цепочки.
    * @param {WS.Data/Chain/Abstract} source Предыдущее звено.
    * @param {Array.<Array>|Array.<WS.Data/Collection/IEnumerable>} items Коллекции для объединения.
    */
   constructor(source: Abstract<T>, items: Array<Array<T> | IEnumerable<T>>) {
      super(source);
      this._items = items;
   }

   destroy() {
      this._items = null;
      super.destroy();
   }

   // region Data/_collection/IEnumerable

   getEnumerator(): ConcatenatedEnumerator<T> {
      return new ConcatenatedEnumerator(
         this._previous,
         this._items
      );
   }

   // endregion Data/_collection/IEnumerable
}

Concatenated.prototype['[Data/_chain/Concatenated]'] = true;

   // @ts-ignore
Concatenated.prototype._items = null;

Object.defineProperty(Concatenated.prototype, 'shouldSaveIndices', { value: false });
