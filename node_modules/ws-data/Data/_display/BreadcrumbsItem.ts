/// <amd-module name="Data/_display/BreadcrumbsItem" />
/**
 * Хлебная крошка
 * @class WS.Data/Display/BreadcrumbsItem
 * @extends WS.Data/Display/CollectionItem
 * @public
 * @author Мальцев А.А.
 */

import CollectionItem, {IOptions as ICollectionItemOptions} from './CollectionItem';
import TreeItem from './TreeItem';
import {di} from '../util';

export interface IOptions extends ICollectionItemOptions {
   last: CollectionItem;
}

export default class BreadcrumbsItem extends CollectionItem /** @lends WS.Data/Display/BreadcrumbsItem.prototype */{
   _instancePrefix: 'breadcrumbs-item-';

   /**
    * @cfg {WS.Data/Collection/TreeItem} Последний элемент хлебной крошки
    * @name WS.Data/Display/BreadcrumbsItem#last
    */
   protected _$last: CollectionItem;

   constructor(options: IOptions) {
      super(options);
   }

   // region Public methods

   getContents() {
      const root = this._$owner ? this._$owner.getRoot() : {};
      let current = this._$last;
      let contents = [];

      // Go up from last item until end
      while (current) {
         contents.unshift(current.getContents());
         current = current.getParent();
         if (current === root) {
            break;
         }
      }

      return contents;
   }

   setContents() {
      throw new ReferenceError('BreadcrumbsItem contents is read only.');
   }

   // endregion
}

BreadcrumbsItem.prototype._moduleName = 'Data/display:BreadcrumbsItem';
BreadcrumbsItem.prototype['[Data/_display/BreadcrumbsItem]'] = true;
// @ts-ignore
BreadcrumbsItem.prototype._$last = null;

di.register('Data/display:BreadcrumbsItem', BreadcrumbsItem);
