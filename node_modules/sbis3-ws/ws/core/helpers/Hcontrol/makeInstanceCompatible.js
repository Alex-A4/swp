define('Core/helpers/Hcontrol/makeInstanceCompatible', [
   'Core/Abstract.compatible',
   'Lib/Control/Control.compatible',
   'Lib/Control/AreaAbstract/AreaAbstract.compatible',
   'Lib/Control/BaseCompatible/BaseCompatible'
], function(AbstractCompatible, ControlCompatible, AreaAbstractCompatible, BaseCompatible) {
   function mix(inst, mixin) {
      for (var key in mixin) {
         if (mixin.hasOwnProperty(key) && !inst[key]) {
            inst[key] = mixin[key];
         }
      }
   }

   /**
    * Функция makeInstanceCompatible(inst) встраивает слой совместимости
    * в конкретный инстанс контрола inst.
    *
    * Для этого она подмешивает к инстансу поведение из модулей BaseCompatible,
    * AreaAbstract.compatible, Control.compatible и Abstract.compatible
    *
    * С таким vdom-компонентом, к которому подмешан слой совместимости, могут
    * "прозрачно" работать CompoundControl'ы.
    */
   return function makeInstanceCompatible(inst) {
      // Подмешиваем поведение из модулей слоя совместимости
      mix(inst, BaseCompatible);
      mix(inst, AreaAbstractCompatible);
      mix(inst, ControlCompatible);
      mix(inst, AbstractCompatible);

      // Вызываем deprecatedContr из BaseCompatible, чтобы проинициализировать
      // все поля, которые могут понадобиться старым контролам
      if (inst.deprecatedContr) {
         inst.deprecatedContr(inst._options);
      }

      // Определяем значения опций для декорирования: class, style,
      // data-component, config
      if (!inst._decOptions) {
         inst._decOptions = inst._prepareDecOptions();
      }
   };
});
