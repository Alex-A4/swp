/**
 * Created by as.krasilnikov on 21.09.15.
 */
define('Deprecated/res/wsmodules/ValidateCountDialog/ValidateCountDialog',
   [  'Lib/Control/CompoundControl/CompoundControl',
      'html!Deprecated/res/wsmodules/ValidateCountDialog/ValidateCountDialog',
      'Lib/CoreValidators/CoreValidators',
      'css!Deprecated/res/wsmodules/ValidateCountDialog/ValidateCountDialog',
      'Deprecated/Controls/FieldInteger/FieldInteger',
      'Deprecated/Controls/FieldRadio/FieldRadio',
      'Deprecated/Controls/Button/Button'
   ], function (CompoundControl, dotTplFn, CoreValidators) {

      /**
       * Deprecated/res/wsmodules/ValidateCountDialog/ValidateCountDialog
       * @extends Lib/Control/CompoundControl/CompoundControl
       */
      var ValidateCountDialog = CompoundControl.extend({
         _dotTplFn: dotTplFn,
         $protected: {
            _options: {
               autoWidth: false,
               autoHeight: false,
               width: '363px',
               height: '143px'
            }
         },
         $constructor: function () {
            var self = this;
            this.subscribe('onAfterLoad', function () {
               self.getChildControlByName('recordsCount')._options.validators.push({
                  validator: CoreValidators.inRange,
                  errorMessage: 'Разрешено не более 10000 записей',
                  params: [0, 10000]
               });

               self.getChildControlByName('radioButtons').subscribe('onChange', function (e, item) {
                  self.getContainer().find('.ws-validateCountDialog-countOfEntry')
                     .toggleClass('ws-hidden', item.toString() !== 'countRecords')
               });
            });
         }
      });
      return ValidateCountDialog;
   });
